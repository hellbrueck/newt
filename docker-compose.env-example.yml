# Example docker-compose.yml with direct environment variables
# This is an alternative to using the .env file approach
# Copy this file to docker-compose.yml and replace the placeholder values

services:
  # Newt tunneling client service
  newt:
    # Official newt Docker image from fosrl
    image: fosrl/newt
    container_name: newt
    restart: unless-stopped
    
    # Required capabilities for WireGuard tunnel and network operations
    cap_add:
      - NET_ADMIN      # Required for network interface management
      - SYS_MODULE     # Required for WireGuard kernel module operations
    
    # Direct environment variable configuration (alternative to env_file)
    # Replace the placeholder values with your actual configuration
    environment:
      - PANGOLIN_ENDPOINT=https://pangolin.th-luebeck.me
      - NEWT_ID=your_newt_client_id_here
      - NEWT_SECRET=your_newt_client_secret_here
    
    # Host resolution configuration for Docker networking
    # This allows both localhost and host.docker.internal to resolve to the host machine
    extra_hosts:
      - "localhost:host-gateway"           # Makes localhost resolve to host machine
      - "host.docker.internal:host-gateway" # Ensures host.docker.internal works (macOS compatibility)
    
    # System configuration for WireGuard compatibility
    sysctls:
      - net.ipv4.conf.all.src_valid_mark=1  # Required for WireGuard routing 